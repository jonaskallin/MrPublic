spring:
  liquibase:
    enabled: true
    change-log: classpath:config/liquibase/master.xml
    contexts: none
  datasource:
    driver-class-name: org.postgresql.Driver
    url: jdbc:postgresql://localhost:5499/postgres
    username: postgres
    password: pgfuseadmin2019
    hikari:
      maximum-pool-size: 30
  jpa:
    open-in-view: true
    properties:
      temp.use_jdbc_metadata_defaults: false
      hibernate.jdbc.lob.non_contextual_creation: true
      hibernate.enable_lazy_load_no_trans: true
      hibernate.order_by.default_null_ordering: last
      default_schema: public
      hibernate:
        jdbc:
          time_zone: UTC
  task:
    execution:
      pool:
        core-size: 32
        max-size: 32
  quartz:
    job-store-type: jdbc
    jdbc:
      initialize-schema: never
    properties:
      "org.quartz.jobStore.driverDelegateClass": org.quartz.impl.jdbcjobstore.PostgreSQLDelegate
  mail:
    # required for MailSenderPropertiesConfiguration to load
    host: ""
    properties:
      "mail.smtp.connectiontimeout": "1000"
      "mail.smtp.timeout": "5000"
      "mail.smtp.starttls.enable": "true"

logging:
  group:
    # when changing log level in administration, these are the loggers that will change
    fuse: "io.vilt.fuse"
  pattern:
    dateformat: yyyy-MM-dd HH:mm:ss.SSS ZZZ

server:
  compression:
    enabled: true
  http2:
    enabled: true
  servlet:
    session:
      timeout: 600

management:
  endpoint:
    health:
      show-details: when_authorized
  endpoints:
    web:
      exposure:
        include: health, info

prometheus:
  http-client:
    pool:
      max-size: 32
      max-per-route: 32
    request:
      connection-request-timeout: 5s
      connect-timeout: 5s
      read-timeout: 60s
    ssl:
      bundle: ${server.ssl.bundle:${http-client.ssl.bundle:}}
      trust-self-signed: ${http-client.ssl.trust-self-signed:false}

  alerts:
    - alert: heartbeat_missing
      expr: (max by (systemId, envId) (otcs_heartbeat_up) or (0 * max by (systemId, envId) (fuse_system_active != 0)))
      interval: 5s
      below: true
      component-type: SYSTEM
      units: BOOLEAN
      title: Is Offline
      summary: "Heartbeat status is unavailable{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS", "OTAC" ]
    - alert: performance_low
      expr: min by (systemId, envId) (system_env:perf)
      interval: 30s
      below: true
      component-type: SYSTEM
      units: PERCENTAGE
      title: Performance
      summary: "Performance is below {{ $threshold | humanizePercentage }}{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS", "OTAC" ]
    - alert: cside_mode_on
      expr: max by (systemId, envId) (otcs_heartbeat_cside_mode)
      interval: 5s
      below: false
      component-type: SYSTEM
      units: BOOLEAN
      title: CSIDE Mode
      summary: "System is running in CSIDE mode (debug)"
      system-types: [ "OTCS" ]
    - alert: app_disk_space_low
      expr: |
        max by (systemId, envId, componentId, componentName, componentClass) (otcs_resource_disk_space_used{appDisk="true"} / otcs_resource_disk_space_total{appDisk="true"})
      metrics-entity: systemdisks
      interval: 5s
      below: false
      component-type: SYSTEM
      units: PERCENTAGE
      title: Application Disk Usage
      summary: "Application disk \"{{ $labels.componentName }}\" usage is above {{ $threshold | humanizePercentage }}{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS", "OTAC" ]
    - alert: noapp_disk_space_low
      expr: |
        max by (systemId, envId, componentId, componentName, componentClass) (otcs_resource_disk_space_used{appDisk="false"} / otcs_resource_disk_space_total{appDisk="false"})
      metrics-entity: systemdisks
      interval: 5s
      below: false
      component-type: SYSTEM
      units: PERCENTAGE
      title: Disk Usage
      summary: "Disk \"{{ $labels.componentName }}\" usage is above {{ $threshold | humanizePercentage }}{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS", "OTAC" ]
    - alert: cpu_high
      expr: max by (systemId, envId) (otcs_resource_system_cpu_load)
      metrics-entity: systemresources
      interval: 30s
      below: false
      component-type: SYSTEM
      units: PERCENTAGE
      title: CPU Usage
      summary: "CPU usage is above {{ $threshold | humanizePercentage }}{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS", "OTAC" ]
    - alert: memory_high
      expr: max by (systemId, envId) (otcs_resource_memory_used / otcs_resource_memory_total)
      metrics-entity: systemresources
      interval: 30s
      below: false
      component-type: SYSTEM
      units: PERCENTAGE
      title: Memory Usage
      summary: "Memory usage is above {{ $threshold | humanizePercentage}}{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS", "OTAC" ]
    - alert: thread_exceptions
      expr: sum by (systemId, envId) (otcs_thread_exceptions_total)
      metrics-entity: threadstatus
      interval: 5s
      below: false
      component-type: THREADS
      units: BOOLEAN
      title: Thread Exceptions
      summary: "Threads are generating exceptions"
      system-types: [ "OTCS" ]
    - alert: thread_usage_high
      expr: sum by (systemId, envId) (sum_over_time(otcs_thread_busy[5m])) / sum by (systemId, envId) (count_over_time(otcs_thread_busy[5m]))
      metrics-entity: threadstatus
      interval: 30s
      below: false
      component-type: THREADS
      units: PERCENTAGE
      title: Threads Usage
      summary: "Threads usage is above {{ $threshold | humanizePercentage }}{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: thread_avg_queue_time_high
      # see https://artemis.vilt-group.com/engineering/fuse/fuse-server/-/issues/3184#note_138584
      expr: avg by (systemId, envId) (otcs_thread_queue_avg + delta(otcs_thread_queue_avg[5m]) * (otcs_thread_request_total / increase(otcs_thread_request_total[5m]) - 1))
      metrics-entity: threadstatus
      interval: 30s
      below: false
      component-type: THREADS
      units: SECONDS
      title: "Threads queue time"
      summary: "Threads average queue time is above {{ $threshold }}s{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: thread_avg_execution_time_high
      # see https://artemis.vilt-group.com/engineering/fuse/fuse-server/-/issues/3184#note_138584
      expr: avg by (systemId, envId) (increase(otcs_thread_execution_time_total[5m]) / increase(otcs_thread_request_total[5m]))
      metrics-entity: threadstatus
      interval: 30s
      below: false
      component-type: THREADS
      units: SECONDS
      title: "Threads avg. request execution time"
      summary: "Threads request average execution time is above {{ $threshold }}s{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: thread_current_execution_time_high
      expr: max by (systemId, envId, componentId, componentName, componentClass) (otcs_thread_request_execution_time_current)
      metrics-entity: threadstatus
      interval: 5s
      below: false
      component-type: THREADS
      units: SECONDS
      title: "Thread \"{{ $labels.componentName }}\" request execution"
      summary: "Thread \"{{ $labels.componentName }}\" current execution time is above {{ $threshold }}s{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: trace_files
      expr: max by (systemId, envId) (otcs_resource_trace_files_total)
      metrics-entity: systemresources
      interval: 5s
      below: false
      component-type: LOGS
      units: BOOLEAN
      title: Trace Files
      summary: "Threads are generating trace files"
      system-types: [ "OTCS" ]
    - alert: log_files_size_high
      expr: sum by (systemId, envId) (otcs_log_files_total_size)
      metrics-entity: logcollection
      interval: 5s
      below: false
      component-type: LOGS
      units: BYTES
      title: Logs Size
      summary: "Log files size above {{ $threshold | humanize1024 }}B"
      system-types: [ "OTCS" ]
    - alert: storage_provider_unavailable
      expr: min by (systemId, envId, componentId, componentName, componentClass) (otcs_storage_provider_available and otcs_storage_provider_blacklisted == 0)
      metrics-entity: spstatus
      interval: 5s
      below: true
      component-type: STORAGE_PROVIDERS
      units: BOOLEAN
      title: "Storage Provider \"{{ $labels.componentName }}\" Availability"
      summary: "Storage provider \"{{ $labels.componentName }}\" is unavailable{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: ll_client_port_available
      expr: min by (systemId, envId, componentId, componentName, componentClass) (otcs_ll_client_port_available_ok)
      metrics-entity: llclientportavailable
      interval: 30s
      below: true
      component-type: SYSTEM
      units: BOOLEAN
      title: "LLClient Connection Error"
      summary: "Error while connecting to LLClient socket port"
      system-types: [ "OTCS" ]
    - alert: configuration_policy_compliance_failures
      expr: sum by (systemId, envId) (fuse_configuration_policy_compliance_failures)
      metrics-entity: configurationpolicycompliance
      interval: 5s
      below: false
      component-type: CONFIGURATIONS
      units: BOOLEAN
      title: Configuration policy compliance failure
      summary: "System is non-compliant with the configuration policies{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: configuration_policy_compliance_conflicts
      expr: sum by (systemId, envId) (fuse_configuration_policy_compliance_conflicts)
      metrics-entity: configurationpolicycompliance
      interval: 5s
      below: false
      component-type: CONFIGURATIONS
      units: BOOLEAN
      title: Configuration policy compliance conflict
      summary: "System has conflicting configuration policies{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: authentication_error
      expr: count by (systemId, envId) (fuse_system_request_status == 401)
      interval: 5s
      below: false
      component-type: SYSTEM
      units: BOOLEAN
      title: Authentication Error
      summary: "Authentication credentials failed. Please review OTDS status or/and if required update your system credentials."
      system-types: [ "OTCS", "OTAC" ]
    - alert: secretkey_error
      expr: count by (systemId, envId) (fuse_system_request_status == 403)
      interval: 5s
      below: false
      component-type: FUSE_CLIENT
      units: BOOLEAN
      title: Secret Key Error
      summary: "Incorrect secret key, please deactivate and re-activate system."
      system-types: [ "OTCS", "OTAC" ]
    - alert: default_admin_server_password
      expr: sum by (systemId, envId) (otcs_system_admin_server_default_password)
      metrics-entity: systeminfo
      interval: 5s
      below: false
      component-type: SYSTEM
      units: BOOLEAN
      title: Security Warning
      summary: "Admin server password is set to default, for security reasons you should consider to change it."
      system-types: [ "OTCS" ]
    - alert: default_admin_user_password
      expr: sum by (systemId, envId) (otcs_system_admin_user_default_password)
      metrics-entity: systeminfo
      interval: 5s
      below: false
      component-type: SYSTEM
      units: BOOLEAN
      title: Security Warning
      summary: "Admin user password is set to default, for security reasons you should consider to change it."
      system-types: [ "OTCS" ]
    - alert: dump_files
      expr: sum by (systemId, envId) (otcs_resource_dump_files_total)
      metrics-entity: systemresources
      interval: 5s
      below: false
      component-type: SYSTEM
      units: BYTES
      title: Java Crash Dump File(s)
      summary: "System is generating Java Crash dump file(s) ({{ $value | humanize1024 }}B). This could mean that the application JVM crashed, these files can also cause high consumption of the application disks."
      system-types: [ "OTCS" ]
    - alert: storage_provider_extshared_free_space
      expr: sum by (envId, componentId, componentName, componentClass) (otcs_storage_provider_disk_space_total{type="EXTSHARED"} - otcs_storage_provider_disk_space_used{type="EXTSHARED"})
      metrics-entity: spstatus
      interval: 30s
      below: true
      component-type: STORAGE_PROVIDERS
      alert-type: ENVIRONMENT
      units: BYTES
      title: "Storage Provider \"{{ $labels.componentName }}\" Free Space"
      summary: "Storage provider \"{{ $labels.componentName }}\" available disk space is below {{ $threshold | humanize1024 }}B{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: storage_provider_extshared_cant_write
      expr: count by (systemId, envId, componentId, componentName, componentClass) (otcs_storage_provider_can_write{type="EXTSHARED"} == 0)
      metrics-entity: spstatus
      interval: 30s
      below: false
      component-type: STORAGE_PROVIDERS
      units: BOOLEAN
      title: "Storage Provider \"{{ $labels.componentName }}\" Write Error"
      summary: "Error while writing to storage provider \"{{ $labels.componentName }}\"{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: storage_provider_extshared_write_performance
      expr: sum by (systemId, envId, componentId, componentName, componentClass) (otcs_storage_provider_write_throughput{type="EXTSHARED"}) * 1024 * 1024
      metrics-entity: spstatus
      interval: 30s
      below: true
      component-type: STORAGE_PROVIDERS
      units: BYTES
      title: "Storage Provider \"{{ $labels.componentName }}\" Write Performance"
      summary: "Storage provider \"{{ $labels.componentName }}\" write performance is below {{ $threshold | humanize1024 }}B/s{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: storage_provider_extshared_read_performance
      expr: sum by (systemId, envId, componentId, componentName, componentClass) (otcs_storage_provider_read_throughput{type="EXTSHARED"}) * 1024 * 1024
      metrics-entity: spstatus
      interval: 30s
      below: true
      component-type: STORAGE_PROVIDERS
      units: BYTES
      title: "Storage Provider \"{{ $labels.componentName }}\" Read Performance"
      summary: "Storage provider \"{{ $labels.componentName }}\" read performance is below {{ $threshold | humanize1024 }}B/s{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: storage_provider_entreprisearchive_cant_write
      expr: count by (systemId, envId, componentId, componentName, componentClass) (otcs_storage_provider_can_write{type="ENTERPRISEARCHIVE"} == 0)
      metrics-entity: spstatus
      interval: 30s
      below: false
      component-type: STORAGE_PROVIDERS
      units: BOOLEAN
      title: "Storage Provider \"{{ $labels.componentName }}\" Write Error"
      summary: "Error while writing to storage provider \"{{ $labels.componentName }}\"{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }} "
      system-types: [ "OTCS" ]
    - alert: storage_provider_entreprisearchive_write_performance
      expr: sum by (systemId, envId, componentId, componentName, componentClass) (otcs_storage_provider_write_throughput{type="ENTERPRISEARCHIVE"}) * 1024 * 1024
      metrics-entity: spstatus
      interval: 30s
      below: true
      component-type: STORAGE_PROVIDERS
      units: BYTES
      title: "Storage Provider \"{{ $labels.componentName }}\" Write Performance"
      summary: "Storage provider \"{{ $labels.componentName }}\" write performance is below {{ $threshold | humanize1024 }}B/s{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: storage_provider_entreprisearchive_read_performance
      expr: sum by (systemId, envId, componentId, componentName, componentClass) (otcs_storage_provider_read_throughput{type="ENTERPRISEARCHIVE"}) * 1024 * 1024
      metrics-entity: spstatus
      interval: 30s
      below: true
      component-type: STORAGE_PROVIDERS
      units: BYTES
      title: "Storage Provider \"{{ $labels.componentName }}\" Read Performance"
      summary: "Storage provider \"{{ $labels.componentName }}\" read performance is below {{ $threshold | humanize1024 }}B/s{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: storage_provider_rdbms_write_performance
      expr: sum by (systemId, envId, componentId, componentName, componentClass) (otcs_storage_provider_write_throughput{type="RDBMS"}) * 1024 * 1024
      metrics-entity: spstatus
      interval: 30s
      below: true
      component-type: STORAGE_PROVIDERS
      units: BYTES
      title: "Storage Provider \"{{ $labels.componentName }}\" Write Performance"
      summary: "Storage provider \"{{ $labels.componentName }}\" write performance is below {{ $threshold | humanize1024 }}B/s{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: storage_provider_rdbms_read_performance
      expr: sum by (systemId, envId, componentId, componentName, componentClass) (otcs_storage_provider_read_throughput{type="RDBMS"}) * 1024 * 1024
      metrics-entity: spstatus
      interval: 30s
      below: true
      component-type: STORAGE_PROVIDERS
      units: BYTES
      title: "Storage Provider \"{{ $labels.componentName }}\" Read Performance"
      summary: "Storage provider \"{{ $labels.componentName }}\" read performance is below {{ $threshold | humanize1024 }}B/s{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: fuse_client_otcs_sp_test_binary
      expr: sum by (systemId, envId, componentId, componentName, componentClass) (otcs_storage_provider_test_binary{type="EXTSHARED"} == 0)
      metrics-entity: spstatus
      interval: 30s
      below: true
      admin: true
      component-type: STORAGE_PROVIDERS
      units: BOOLEAN
      title: "Storage Provider \"{{ $labels.componentName }}\" node version error"
      summary: "The test node used for Storage Provider probing has version errors. Please, manually delete the node named with this System ID from the 'Staging' folder within the Fuse Volume."
      system-types: [ "OTCS" ]
    - alert: da_agent_status_stopped
      expr: count by (systemId, envId, componentId, componentName, componentClass) (otcs_da_agent_status == 2)
      metrics-entity: dasystemprocesses
      interval: 1m
      below: false
      component-type: DISTRIBUTED_AGENT
      units: BOOLEAN
      title: "Distributed Agent \"{{ $labels.componentName }}\" Stopped"
      summary: "Distributed Agent \"{{ $labels.componentName }}\" is stopped{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: da_agent_status_stand_by
      expr: count by (systemId, envId, componentId, componentName, componentClass) (otcs_da_agent_status == 4)
      metrics-entity: dasystemprocesses
      interval: 1m
      below: false
      component-type: DISTRIBUTED_AGENT
      units: BOOLEAN
      title: "Distributed Agent \"{{ $labels.componentName }}\" Standing By"
      summary: "Distributed Agent \"{{ $labels.componentName }}\" is standing by{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: da_agent_status_offline
      expr: count by (systemId, envId, componentId, componentName, componentClass) (otcs_da_agent_status == 5)
      metrics-entity: dasystemprocesses
      interval: 1m
      below: false
      component-type: DISTRIBUTED_AGENT
      units: BOOLEAN
      title: "Distributed Agent \"{{ $labels.componentName }}\" Offline"
      summary: "Distributed Agent \"{{ $labels.componentName }}\" is offline{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: da_worker_status_stopped
      expr: count by (systemId, envId, componentId, componentName, componentClass) (otcs_da_worker_status == 2)
      metrics-entity: dasystemprocesses
      interval: 1m
      below: false
      component-type: DISTRIBUTED_AGENT
      units: BOOLEAN
      title: "Worker Agent \"{{ $labels.componentName }}\" Stopped"
      summary: "Worker Agent \"{{ $labels.componentName }}\" is stopped{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: da_worker_status_paused
      expr: count by (systemId, envId, componentId, componentName, componentClass) (otcs_da_worker_status == 3)
      metrics-entity: dasystemprocesses
      interval: 1m
      below: false
      component-type: DISTRIBUTED_AGENT
      units: BOOLEAN
      title: "Worker Agent \"{{ $labels.componentName }}\" Paused"
      summary: "Worker Agent \"{{ $labels.componentName }}\" is paused{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: da_worker_status_offline
      expr: count by (systemId, envId, componentId, componentName, componentClass) (otcs_da_worker_status == 5)
      metrics-entity: dasystemprocesses
      interval: 1m
      below: false
      component-type: DISTRIBUTED_AGENT
      units: BOOLEAN
      title: "Worker Agent \"{{ $labels.componentName }}\" Offline"
      summary: "Worker Agent \"{{ $labels.componentName }}\" is offline{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: da_primary_agent_undefined
      expr: sum by (envId) ( otcs_da_primary_agent_defined ) and sum by (envId) (otcs_da_agents_total_count) > 1
      metrics-entity: dasystemprocesses
      interval: 1m
      below: true
      alert-type: ENVIRONMENT
      component-type: DISTRIBUTED_AGENT
      units: BOOLEAN
      title: Primary Distributed Agent not defined
      summary: "No Distributed Agent has been selected as the Primary Agent."
      system-types: [ "OTCS" ]
    - alert: da_total_task_error
      expr: sum by (systemId, envId, componentClass, componentName, componentId) (otcs_da_total_task_error)
      metrics-entity: dasystemprocesses
      interval: 1m
      below: false
      component-type: DISTRIBUTED_AGENT
      units: BOOLEAN
      title: Distributed Agent Task Error
      summary: "Distributed agent \"{{ $labels.componentId }}\" has {{ $value }} task errors."
      system-types: [ "OTCS" ]
    - alert: da_is_da_worker_available
      expr: sum by (systemId, envId) (otcs_is_da_worker_available) == 0
      metrics-entity: dasystemprocesses
      interval: 1m
      below: true
      component-type: DISTRIBUTED_AGENT
      units: BOOLEAN
      title: Worker Agent Subsystem Status Error
      summary: "Error while attempting to retrieve the status of the Worker subsystem."
      system-types: [ "OTCS" ]
    - alert: da_is_da_agent_available
      expr: sum by (systemId, envId) (otcs_is_da_agent_available) == 0
      metrics-entity: dasystemprocesses
      interval: 1m
      below: true
      component-type: DISTRIBUTED_AGENT
      units: BOOLEAN
      title: Distributed Agent Subsystem Status Error
      summary: "Error while attempting to retrieve the status of the Distributed Agent subsystem."
      system-types: [ "OTCS" ]
    - alert: sov_processes_status_idle
      expr: count by (envId, componentId, componentName, componentClass) (otcs_sov_processes_status == 0) and on (envId) (max by (envId) (otcs_sov_admserv_safe_mode) == 0)
      metrics-entity: sovstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "SOV Process \"{{ $labels.componentName }}\" is Idle"
      summary: "SOV process \"{{ $labels.componentName }}\" is idle to Admin Server{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: sov_processes_status_unknown
      expr: count by (envId, componentId, componentName, componentClass) (otcs_sov_processes_status == -1)
      metrics-entity: sovstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "SOV Process \"{{ $labels.componentName }}\" Unknown Status"
      summary: "SOV process \"{{ $labels.componentName }}\" is unknown to Admin Server{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: sov_processes_status_error
      expr: count by (envId, componentId, componentName, componentClass) (otcs_sov_processes_status == -2)
      metrics-entity: sovstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "SOV Process \"{{ $labels.componentName }}\" Error"
      summary: "SOV process \"{{ $labels.componentName }}\" is in error state{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: sov_processes_status_admin_server_error
      expr: count by (envId, componentId, componentName, componentClass) (otcs_sov_processes_status == -3)
      metrics-entity: sovstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "SOV Process Admin Server Error"
      summary: "SOV process Admin Server error{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: sov_processes_status_not_exist
      expr: count by (envId, componentId, componentName, componentClass) (otcs_sov_processes_status == -4) and on (envId) (max by (envId) (otcs_sov_admserv_safe_mode) == 0)
      metrics-entity: sovstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "SOV Process \"{{ $labels.componentName }}\" Does Not Exist"
      summary: "SOV process \"{{ $labels.componentName }}\" does not exist on Admin server{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: sov_processes_status_error_11
      expr: count by (envId, componentId, componentName, componentClass) (otcs_sov_processes_status == -11)
      metrics-entity: sovstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "SOV Process \"{{ $labels.componentName }}\" Error"
      summary: "SOV process \"{{ $labels.componentName }}\" error{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: sov_admserv_active
      expr: max by (envId, componentId, componentName, componentClass) (otcs_sov_admserv_active)
      metrics-entity: sovstatus
      interval: 30s
      below: true
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "Admin Server \"{{ $labels.componentName }}\" is Offline"
      summary: "Admin Server \"{{ $labels.componentName }}\" is offline{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: sov_admserv_safe_mode
      expr: min by (envId, componentId, componentName, componentClass) (otcs_sov_admserv_safe_mode)
      metrics-entity: sovstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "Admin Server \"{{ $labels.componentName }}\" is in Safe Mode"
      summary: "Admin Server \"{{ $labels.componentName }}\" is in safe mode{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: sov_ipool_quarantined
      expr: max by (envId, componentId, componentName, componentClass) (otcs_sov_ipool_quarantined)
      metrics-entity: sovstatus
      interval: 5s
      below: false
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "iPool \"{{ $labels.componentName }}\" Quarantine Warning"
      summary: "iPool \"{{ $labels.componentName }}\" has quarantined items"
      system-types: [ "OTCS" ]
    - alert: sov_partition_unavailable
      expr: max by (envId, componentId, componentName, componentClass) (otcs_sov_partition_available)
      metrics-entity: sovstatus
      interval: 30s
      below: true
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "Partition \"{{ $labels.componentName }}\" is Unavailable"
      summary: "Partition \"{{ $labels.componentName }}\" is unavailable{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: sov_partition_full
      expr: max by (envId, componentId, componentName, componentClass) (otcs_sov_partition_state) == 2
      metrics-entity: sovstatus
      interval: 5s
      below: false
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "Partition \"{{ $labels.componentName }}\" is Full"
      summary: "Partition \"{{ $labels.componentName }}\" has reached the maximum capacity defined in this Partition Settings{{ if $forSeconds }} ,for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: sov_partition_almost_full
      expr: max by (envId, componentId, componentName, componentClass) (otcs_sov_partition_state) == 1
      metrics-entity: sovstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "Partition \"{{ $labels.componentName }}\" is Almost Full"
      summary: "Partition \"{{ $labels.componentName }}\" is almost reaching the maximum capacity defined in this Partition Settings{{ if $forSeconds }} ,for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: sov_search_unavailable
      expr: max by (envId, componentId, componentName, componentClass) (otcs_sov_search_available)
      metrics-entity: searchstatus
      interval: 30s
      below: true
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "Search is not Available"
      summary: "Search service features are not available {{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: sov_partition_missing_index_process
      expr: max by (envId, componentId, componentName, componentClass) (otcs_sov_partition_missing_index_process)
      metrics-entity: sovstatus
      interval: 30s
      below: true
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "Missing Index Process"
      summary: "Missing index process for \"{{ $labels.componentName }}\""
    - alert: sov_partition_missing_search_process
      expr: max by (envId, componentId, componentName, componentClass) (otcs_sov_partition_missing_search_process)
      metrics-entity: sovstatus
      interval: 30s
      below: true
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "Missing Search Process"
      summary: "Missing search process for \"{{ $labels.componentName }}\""
    - alert: agent_nextstart_failed
      expr: otcs_heartbeat_last_time - on(systemId, envId) group_right() (min by (systemId, envId, componentId, componentName, componentClass) (otcs_agent_nextstart_seconds) + scalar(min(fuse_alert_for{alertname="agent_nextstart_failed",severity="[[severity]]"}))) and max by(systemId, envId, componentId, componentName, componentClass) (otcs_agent_activated) > 0 and max by(systemId, envId, componentId, componentName, componentClass) (otcs_agent_enabled) > 0
      metrics-entity: agentstatus
      interval: 1m
      below: false
      component-type: AGENTS
      units: BOOLEAN
      title: Agent Scheduled Next Run Failed
      summary: "Agent \"{{ $labels.componentName }}\" has failed its scheduled next run{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: verify_agent_multiple_instances
      expr: (count by (envId) (otcs_loaderprocess_alive{componentName="verifyAgent"} == 1) and count by (envId) (otcs_agent_activated{componentId="12568"} == 1) ) > 1
      metrics-entity: loaderprocesses
      interval: 5s
      below: false
      alert-type: ENVIRONMENT
      component-type: AGENTS
      units: BOOLEAN
      title: Environment 'VerifyAgent' process error
      summary: "Multiple instances of the 'Verify Agent' process ({{ $value }}) are enabled on this environment, only 1 instance is allowed per environment."
      system-types: [ "OTCS" ]
    - alert: queuetables_d_tree_notify
      expr: max by (envId) ((sgn(idelta(otcs_queuetables_d_tree_notify[5m])) >= 0 and otcs_queuetables_d_tree_notify > 0) + 1) or on() vector(0)
      metrics-entity: queuetablesstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: QUEUE_TABLES
      units: BOOLEAN
      title: Queue Table DTreeNotify Object Processing Warning
      summary: "Queue table DTreeNotify is not being flushed and/or is increasing{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: queuetables_ll_event_queue
      expr: max by (envId) ((sgn(idelta(otcs_queuetables_ll_event_queue[5m])) >= 0 and otcs_queuetables_ll_event_queue > 0) + 1) or on() vector(0)
      metrics-entity: queuetablesstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: QUEUE_TABLES
      units: BOOLEAN
      title: Queue Table LLEvent Object Processing Warning
      summary: "Queue table LLEvent is not being flushed and/or is increasing{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: queuetables_notify_events
      expr: max by (envId) ((sgn(idelta(otcs_queuetables_notify_events[5m])) >= 0 and otcs_queuetables_notify_events > 0) + 1) or on() vector(0)
      metrics-entity: queuetablesstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: QUEUE_TABLES
      units: BOOLEAN
      title: Queue Table NotifyEvents Object Processing Warning
      summary: "Queue table NotifyEvents is not being flushed and/or is increasing{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: queuetables_notify_messages
      expr: max by (envId) ((sgn(idelta(otcs_queuetables_notify_messages[5m])) >= 0 and otcs_queuetables_notify_messages > 0) + 1) or on() vector(0)
      metrics-entity: queuetablesstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: QUEUE_TABLES
      units: BOOLEAN
      title: Queue Table NotifyMessages Object Processing Warning
      summary: "Queue table NotifyMessages is not being flushed and/or is increasing{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: queuetables_provider_retry
      expr: max by (envId) ((idelta(otcs_queuetables_provider_retry[5m]) > 0 and otcs_queuetables_provider_retry > 0) + 1) or on() vector(0)
      metrics-entity: queuetablesstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: QUEUE_TABLES
      units: BOOLEAN
      title: Queue Table ProviderRetry Growth Warning
      summary: "The ProviderRetry queue table entries are increasing persistently{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: queuetables_rendition_queue
      expr: max by (envId) ((sgn(idelta(otcs_queuetables_rendition_queue[5m])) >= 0 and otcs_queuetables_rendition_queue > 0) + 1) or on() vector(0)
      metrics-entity: queuetablesstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: QUEUE_TABLES
      units: BOOLEAN
      title: Queue Table Rendition Object Processing Warning
      summary: "Queue table Rendition is not being flushed and/or is increasing{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: queuetables_worker_queue
      expr: max by (envId) ((sgn(idelta(otcs_queuetables_worker_queue[5m])) >= 0 and otcs_queuetables_worker_queue > 0) + 1) or on() vector(0)
      metrics-entity: queuetablesstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: QUEUE_TABLES
      units: BOOLEAN
      title: Queue Table Worker Object Processing Warning
      summary: "Queue table Worker is not being flushed and/or is increasing{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: queuetables_worker_queue_pending
      expr: max by (envId) ((sgn(idelta(otcs_queuetables_worker_queue_pending[5m])) >= 0 and otcs_queuetables_worker_queue_pending > 0) + 1) or on() vector(0)
      metrics-entity: queuetablesstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: QUEUE_TABLES
      units: BOOLEAN
      title: Queue Table WorkerPending Object Processing Warning
      summary: "Queue table WorkerPending is not being flushed and/or is increasing{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: invalid_client_version
      expr: max by (systemId, envId) (fuse_client_version_valid)
      interval: 5s
      below: true
      component-type: FUSE_CLIENT
      units: BOOLEAN
      title: Fuse Management Client Compatibility Warning
      summary: "Please upgrade Fuse Management Client to avoid compatibility issues"
      system-types: [ "OTCS", "OTAC" ]
    - alert: sov_ipool_idle
      expr: count by (envId, componentId, componentName, componentClass) (otcs_sov_ipool_active == 0)
      metrics-entity: sovstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "iPool \"{{ $labels.componentName }}\" is Idle"
      summary: "iPool \"{{ $labels.componentName }}\" is idle{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: sov_ipool_pending
      expr: max by (envId, componentId, componentName, componentClass) (otcs_sov_ipool_pending)
      metrics-entity: sovstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: SOV
      units: NUMBER
      title: "iPool \"{{ $labels.componentName }}\" Pending Messages Processing Warning"
      summary: "The System Object Volume IPool \"{{ $labels.componentName }}\" has a pending messages count exceeding the threshold of {{ $threshold }}{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}. Pending IPool messages may indicate a process is not working properly, stopped, or system bottlenecks."
      system-types: [ "OTCS" ]
    - alert: sov_dataflow_idle
      expr: count by (envId, componentId, componentName, componentClass) (otcs_sov_dataflow_idle == 1)
      metrics-entity: sovstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: "Data Flow is Suspended"
      summary: "Data Flow \"{{ $labels.componentName }}\" is suspended{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: database_query_performance
      expr: max by (systemId, envId, componentId, componentName, componentClass) (otcs_db_query_execution_time)
      metrics-entity: dbperformance
      interval: 5s
      below: false
      component-type: DB_PERFORMANCE
      units: MILLISECONDS
      title: "Database Query Performance Issue in \"{{ $labels.componentName }}\""
      summary: "Queries to table \"{{ $labels.componentName }}\" are taking more than {{ $threshold }}ms {{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: extendedecm_system_status
      expr: max by (systemId, envId, componentId, componentName, componentClass) (otcs_extendedecm_system_status)
      metrics-entity: xecmexternalsystems
      interval: 30s
      below: true
      component-type: XECM
      units: BOOLEAN
      title: "Business Application \"{{ $labels.componentName }}\" is Unavailable"
      summary: "Business Application \"{{ $labels.componentName }}\" is unavailable {{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: extendedecm_system_auth_status
      expr: max by (systemId, envId, componentId, componentName, componentClass) (otcs_extendedecm_system_auth_status)
      metrics-entity: xecmexternalsystems
      interval: 30s
      below: true
      component-type: XECM
      units: BOOLEAN
      title: "Business Application \"{{ $labels.componentName }}\" Authentication Error"
      summary: "Business Application \"{{ $labels.componentName }}\" is failing authentication  {{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: extendedecm_job_status
      expr: max by (envId, componentId, componentName, componentClass) (otcs_extendedecm_job_status)
      metrics-entity: xecmlicensingandjobs
      interval: 30s
      below: true
      alert-type: ENVIRONMENT
      component-type: XECM
      units: BOOLEAN
      title: "Scheduled Job {{ $labels.componentName }} Status Error"
      summary: "Schedule job \"{{ $labels.componentName }}\" is in error state {{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: extendedecm_job_error_items
      expr: max by (envId, componentId, componentName, componentClass) (otcs_extendedecm_job_error_items)
      metrics-entity: xecmlicensingandjobs
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: XECM
      units: BOOLEAN
      title: "Scheduled Job {{ $labels.componentName }} has Error Items"
      summary: "Schedule job \"{{ $labels.componentName }}\" has error items ({{ $value }}) {{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTCS" ]
    - alert: extendedecm_licensing_userlicense_issue
      expr: max by (envId, componentClass) (otcs_extendedecm_licensing_userlicense_issue)
      metrics-entity: xecmlicensingandjobs
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: XECM
      units: BOOLEAN
      title: "Extended ECM Licensing Issues"
      summary: "Extended ECM has licensing issues, please review this component license usage"
      system-types: [ "OTCS" ]
    - alert: stale_metric
      expr: max by (systemId, envId, componentId, componentName, componentClass, metricsEntity) (fuse_stale_metric * on(systemId, envId) group_left() otcs_heartbeat_up)
      interval: 5s
      below: false
      admin: true
      component-type: HEALTH
      units: BOOLEAN
      title: "Metric is Stale"
      summary: "Metric group \"{{ $labels.componentName }}\" is stale, values can be inaccurate from actual values."
      system-types: [ "OTCS", "OTAC" ]
    - alert: health_disk
      expr: sum by (name) (1 - (fuse_health_os_disk_free/fuse_health_os_disk_total))
      interval: 1m
      below: false
      admin: true
      component-type: HEALTH
      units: PERCENTAGE
      title: "Disk Space Status"
      summary: "Fuse Management Central application disk space has reached critical level."
    - alert: health_prometheus
      expr: count by (status) (fuse_health{componentId="prometheus"} == 0)
      interval: 1m
      below: true
      admin: true
      component-type: HEALTH
      units: BOOLEAN
      title: "Metrics Database Status"
      summary: "Fuse Management Central Metrics Database is not available."
    - alert: health_mail
      expr: count by (status) (fuse_health{componentId="mail"} == 0)
      interval: 1m
      below: true
      admin: true
      component-type: HEALTH
      units: BOOLEAN
      title: "Mail Status"
      summary: "SMTP Server is not available."
    - alert: health_database
      expr: count by (status) (fuse_health{componentId="database"} == 0)
      interval: 1m
      below: true
      admin: true
      component-type: HEALTH
      units: BOOLEAN
      title: "Database Status"
      summary: "Fuse Management Central Database is not available."
    - alert: health_alert_manager
      expr: count by (status) (fuse_health{componentId="alert_manager"} == 0)
      interval: 1m
      below: true
      admin: true
      component-type: HEALTH
      units: BOOLEAN
      title: "Alert Manager Status"
      summary: "Fuse Management Central Alert Manager is not available."
    - alert: health_service_now
      expr: count by (status) (fuse_health{componentId="service_now"} == 0)
      interval: 1m
      below: true
      admin: true
      component-type: HEALTH
      units: BOOLEAN
      title: "ServiceNow Status"
      summary: "ServiceNow is not available."
    - alert: health_smax
      expr: count by (status) (fuse_health{componentId="smax"} == 0)
      interval: 1m
      below: true
      admin: true
      component-type: HEALTH
      units: BOOLEAN
      title: "SMAX Status"
      summary: "SMAX is not available."
    - alert: otac_archive_no_pools
      expr: count by (systemId, envId, componentId, componentName, componentClass) (otac_archive_total_pools{componentClass="otac_archive_original"} == 0)
      metrics-entity: archives
      interval: 30s
      below: false
      component-type: OTAC_ARCHIVE
      units: BOOLEAN
      title: "Logical Archive \"{{ $labels.componentId }}\" Pool Warning"
      summary: "Logical Archive \"{{ $labels.componentId }}\" has no pools assigned{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}, please add at least one pool to this logical archive"
      system-types: [ "OTAC" ]
    - alert: otac_pool_no_volumes
      expr: count by (systemId, envId, componentId, componentName, componentClass) (otac_archive_pool_total_volumes == 0)
      metrics-entity: archives
      interval: 30s
      below: false
      component-type: OTAC_POOL
      units: BOOLEAN
      title: "Pool \"{{ $labels.componentName }}\" has no Volumes"
      summary: "Pool \"{{ $labels.componentName }}\" (Archive \"{{ $labels.componentId }}\") has no volumes assigned{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}, please attach at least one volume to this pool"
      system-types: [ "OTAC" ]
    - alert: otac_storage_device_detached
      expr: count by (systemId, envId, componentId, componentName, componentClass) (otac_storage_device_status == 0)
      metrics-entity: storagedevices
      interval: 30s
      below: false
      component-type: OTAC_STORAGE_DEVICE
      units: BOOLEAN
      title: "Storage Device \"{{ $labels.componentName }}\" is Detached"
      summary: "Storage Device \"{{ $labels.componentName }}\" is detached and unavailable{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTAC" ]
    - alert: otac_storage_device_aborted
      expr: count by (systemId, envId, componentId, componentName, componentClass) (otac_storage_device_status == 4)
      metrics-entity: storagedevices
      interval: 30s
      below: false
      component-type: OTAC_STORAGE_DEVICE
      units: BOOLEAN
      title: "Storage Device \"{{ $labels.componentName }}\" With Aborted Connection"
      summary: "Connection to Storage Device \"{{ $labels.componentName }}\" was aborted being unavailable{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTAC" ]
    - alert: otac_storage_device_free_space_high
      expr: min by (systemId, envId, componentId, componentName, componentClass) (otac_storage_device_total_free_space / otac_storage_device_total_capacity)
      metrics-entity: storagedevices
      interval: 30s
      below: true
      component-type: OTAC_STORAGE_DEVICE
      units: PERCENTAGE
      title: "Storage Device \"{{ $labels.componentName }}\" Free Space Warning"
      summary: "Storage Device \"{{ $labels.componentName }}\" free space is below {{ $threshold | humanizePercentage}}{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTAC" ]
    - alert: otac_storage_device_free_space_limit
      expr: count by (systemId, envId, componentId, componentName, componentClass) ((otac_storage_device_total_free_space / otac_storage_device_total_capacity) == 0)
      metrics-entity: storagedevices
      interval: 30s
      below: false
      component-type: OTAC_STORAGE_DEVICE
      units: BOOLEAN
      title: "Storage Device \"{{ $labels.componentName }}\" Free Space Error"
      summary: "Storage Device \"{{ $labels.componentName }}\" free space has reached the limit"
      system-types: [ "OTAC" ]
    - alert: otac_buffer_no_volumes_attached
      expr: count by (systemId, envId, componentId, componentName, componentClass) (otac_buffer_has_volumes == 0)
      metrics-entity: buffers
      interval: 30s
      below: false
      component-type: OTAC_BUFFER
      units: BOOLEAN
      title: "Buffer \"{{ $labels.componentName }}\" has no Volumes"
      summary: "Buffer \"{{ $labels.componentName }}\" has no volumes attached{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}, please attach at least one volume to this buffer"
      system-types: [ "OTAC" ]
    - alert: otac_service_status_error
      expr: count by (systemId, envId, componentId, componentName, componentClass) ( otac_service_status != 0)
      metrics-entity: servicesstatus
      interval: 30s
      below: false
      component-type: OTAC_SERVICE
      units: BOOLEAN
      title: "\"{{ $labels.componentName }}\" Status Error"
      summary: "Service \"{{ $labels.componentName }}\" status is returning error"
      system-types: [ "OTAC" ]
    - alert: otac_pool_free_space_high
      expr: min by (systemId, envId, componentId, componentName, componentClass) (otac_archive_pool_total_free_space / otac_archive_pool_total_capacity)
      metrics-entity: archives
      interval: 30s
      below: true
      component-type: OTAC_POOL
      units: PERCENTAGE
      title: "Pool \"{{ $labels.componentName }}\" Free Space Warning"
      summary: "Pool \"{{ $labels.componentName }}\" free space is below {{ $threshold | humanizePercentage}}{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTAC" ]
    - alert: otac_pool_free_space_limit
      expr: count by (systemId, envId, componentId, componentName, componentClass) (otac_archive_pool_full == 1)
      metrics-entity: archives
      interval: 30s
      below: false
      component-type: OTAC_POOL
      units: BOOLEAN
      title: "Pool \"{{ $labels.componentName }}\" Free Space Error"
      summary: "Pool \"{{ $labels.componentName }}\" free space has reached the limit"
      system-types: [ "OTAC" ]
    - alert: otac_buffer_free_space_high
      expr: min by (systemId, envId, componentId, componentName, componentClass) (otac_buffer_total_free_space / otac_buffer_total_capacity)
      metrics-entity: buffers
      interval: 30s
      below: true
      component-type: OTAC_BUFFER
      units: PERCENTAGE
      title: "Buffer \"{{ $labels.componentName }}\" Free Space Warning"
      summary: "Buffer \"{{ $labels.componentName }}\" free space is below {{ $threshold | humanizePercentage}}{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}"
      system-types: [ "OTAC" ]
    - alert: otac_buffer_free_space_limit
      expr: count by (systemId, envId, componentId, componentName, componentClass) (otac_buffer_pool_full == 1)
      metrics-entity: buffers
      interval: 30s
      below: false
      component-type: OTAC_BUFFER
      units: BOOLEAN
      title: "Buffer \"{{ $labels.componentName }}\" Free Space Error"
      summary: "Pool \"{{ $labels.componentName }}\" free space has reached the limit"
      system-types: [ "OTAC" ]
    - alert: fuse_client_pending_log_configurations
      expr: sum by (systemId, envId) (fuse_client_logs_directory_configured)
      metrics-entity: acsysteminfo
      interval: 5s
      below: true
      component-type: FUSE_CLIENT
      units: BOOLEAN
      title: Fuse Management Client - Pending Log Configurations
      summary: "Fuse Management Client is currently with pending log path configurations. Please access Fuse Management Client and review all log settings."
      system-types: [ "OTAC" ]
    - alert: fuse_client_pending_directories_configurations
      expr: sum by (systemId, envId) (fuse_client_directories_configured)
      metrics-entity: acsysteminfo
      interval: 5s
      below: true
      component-type: FUSE_CLIENT
      units: BOOLEAN
      title: Fuse Management Client - Pending Directories Configurations
      summary: "Fuse Management Client is currently with pending directories configurations. Please access Fuse Management Client and review all directories settings."
      system-types: [ "OTAC" ]
    - alert: otac_job_has_protocol_error
      expr: max by (systemId, envId, componentId, componentName, componentClass) (otac_job_has_protocol_error > 0)
      metrics-entity: jobs
      interval: 2m
      below: false
      component-type: OTAC_JOB
      units: BOOLEAN
      title: "Job \"{{ $labels.componentName }}\" Error"
      summary: "Job \"{{ $labels.componentName }}\" has returned protocols errors"
      system-types: [ "OTAC" ]
    - alert: otac_storage_device_unavailable_volumes
      expr: sum by (systemId, envId, componentId, componentName, componentClass) (otac_storage_device_unavailable_volumes_count) > 0
      metrics-entity: storagedevices
      interval: 30s
      below: false
      component-type: OTAC_STORAGE_DEVICE
      units: BOOLEAN
      title: "Storage Device \"{{ $labels.componentId }}\" has {{ $value }} Unavailable Volume(s)"
      summary: "Storage Device \"{{ $labels.componentId }}\" has {{ $value }} unavailable volume(s), please make sure that the requested volume(s) is(are) available in order to retrieve to the requested content."
      system-types: [ "OTAC" ]
    - alert: otac_dp_queue_has_errors
      expr: sum by (systemId, envId, componentId, componentName, componentClass) (otac_dp_queue_errors_count) > 0
      metrics-entity: documentpipelines
      interval: 2m
      below: false
      component-type: OTAC_DOCUMENT_PIPELINES
      units: BOOLEAN
      title: "DocTool \"{{ reReplaceAll \"^[^>]+ > (.*)$\" \"$1\" $labels.componentName }}\" has Error Document(s)"
      summary: "DocTool \"{{ $labels.componentName }}\" has document(s) in the error queue."
      system-types: [ "OTAC" ]
    - alert: otac_dp_queue_disabled
      expr: sum by (systemId, envId, componentId, componentName, componentClass) (otac_dp_queue_status) == 2
      metrics-entity: documentpipelines
      interval: 2m
      below: false
      component-type: OTAC_DOCUMENT_PIPELINES
      units: BOOLEAN
      title: "DocTool \"{{ reReplaceAll \"^[^>]+ > (.*)$\" \"$1\" $labels.componentName }}\" is Disabled"
      summary: "DocTool \"{{ $labels.componentName }}\" is disabled,{{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}."
      system-types: [ "OTAC" ]
    - alert: otac_dp_queue_failed
      expr: sum by (systemId, envId, componentId, componentName, componentClass) (otac_dp_queue_status) == 3
      metrics-entity: documentpipelines
      interval: 2m
      below: false
      component-type: OTAC_DOCUMENT_PIPELINES
      units: BOOLEAN
      title: "DocTool \"{{ reReplaceAll \"^[^>]+ > (.*)$\" \"$1\" $labels.componentName }}\" has Failed to Load"
      summary: "DocTool \"{{ $labels.componentName }}\" has failed to load, please check if any required dependency is missing."
      system-types: [ "OTAC" ]
    - alert: otac_dp_queue_unknown
      expr: sum by (systemId, envId, componentId, componentName, componentClass) (otac_dp_queue_status) == 0
      metrics-entity: documentpipelines
      interval: 2m
      below: false
      component-type: OTAC_DOCUMENT_PIPELINES
      units: BOOLEAN
      title: "Unknown DocTool \"{{ reReplaceAll \"^[^>]+ > (.*)$\" \"$1\" $labels.componentName }}\""
      summary: "Unknown DocTool \"{{ $labels.componentName }}\", please check if this DocTool is properly registered and initialized."
      system-types: [ "OTAC" ]
    - alert: notify_loader_multiple_instances
      expr: count by (envId) (otcs_loaderprocess_alive{componentName="notify"} == 1 and on (systemId) otcs_system_configurations{componentId="processes_options_EnableNotification"} == 1) > 1
      metrics-entity: loaderprocesses
      interval: 5s
      below: false
      alert-type: ENVIRONMENT
      component-type: AGENTS
      units: BOOLEAN
      title: Environment 'Notify' process error
      summary: "Multiple instances of the 'Notify' process ({{ $value }}) are enabled on this environment, only 1 instance is allowed per environment."
      system-types: [ "OTCS" ]
    - alert: agents_loader_false_configuration
      expr: sum by (systemId, envId, componentId, componentName) (otcs_loaderprocess_alive{componentName="agents"} == 1 and on (systemId) otcs_system_configurations{componentId="processes_options_EnableAgents"} == 0) > 0
      metrics-entity: loaderprocesses
      interval: 1m
      below: false
      component-type: LOADERS
      units: BOOLEAN
      title: System agents loader configuration
      summary: "Loader 'agents' is enabled but the 'EnableAgents' configuration is set to FALSE, causing it to not run properly."
      system-types: [ "OTCS" ]
    - alert: notify_loader_false_configuration
      expr: sum by (systemId, envId, componentId, componentName) (otcs_loaderprocess_alive{componentName="notify"} == 1 and on (systemId) otcs_system_configurations{componentId="processes_options_EnableNotification"} == 0) > 0
      metrics-entity: loaderprocesses
      interval: 1m
      below: false
      component-type: LOADERS
      units: BOOLEAN
      title: System notify loader configuration
      summary: "Loader 'notify' is enabled but the 'EnableNotifications' configuration is set to FALSE, causing it to not run properly."
      system-types: [ "OTCS" ]
    - alert: sov_search_federator_network_health
      expr: count by (envId, componentId, componentName, componentClass) (otcs_sov_search_federator_network_health == 0) > 0
      metrics-entity: sovstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: Search Federator network health warning
      summary: "Search Federator \"{{ $labels.componentName }}\" has exceeded the communication retries and failures thresholds, please check the Admin Server network health."
      system-types: [ "OTCS" ]
    - alert: sov_search_federator_connection
      expr: count by (envId, componentId, componentName, componentClass) (otcs_sov_search_federator_connection == 0) > 0
      metrics-entity: sovstatus
      interval: 30s
      below: false
      alert-type: ENVIRONMENT
      component-type: SOV
      units: BOOLEAN
      title: Search Federator connection error
      summary: "Unable to connect to Search Federator \"{{ $labels.componentName }}\" {{ if $forSeconds }} for more than {{ $forSeconds | humanizeDuration }}{{ end }}. Search functionality might not be available."
      system-types: [ "OTCS" ]

otcs:
  http-client:
    pool:
      max-size: 20
      max-per-route: 20
    request:
      connection-request-timeout: 5s
      connect-timeout: 5s
      read-timeout: 60s
    ssl:
      bundle: ${server.ssl.bundle:${http-client.ssl.bundle:}}
      trust-self-signed: ${http-client.ssl.trust-self-signed:false}

  job-execution:
    timeout: 10m
  service-report:
    multi-environment: false

otac:
  http-client:
    pool:
      max-size: 20
      max-per-route: 20
    request:
      connection-request-timeout: 5s
      connect-timeout: 5s
      read-timeout: 60s
    ssl:
      bundle: ${server.ssl.bundle:${http-client.ssl.bundle:}}
      trust-self-signed: ${http-client.ssl.trust-self-signed:false}

integration-channels:
  http-client:
    pool:
      max-size: 20
      max-per-route: 20
    request:
      connection-request-timeout: 5s
      connect-timeout: 5s
      read-timeout: 60s
    ssl:
      bundle: ${server.ssl.bundle:${http-client.ssl.bundle:}}
      trust-self-signed: ${http-client.ssl.trust-self-signed:false}

grafana:
  dashboard:
    base-uris:
      - classpath:grafana/provisioning/dashboards

metrics:
  skip-history: [ "logcollection", "systemresources", "threadstatus", "dbperformance", "metricsinfo" ]
  retention:
    # 31 days
    period: P31D
    # at 01:00 AM every day
    cron: 0 0 1 * * *
  carry:
    # at 01:15 AM every day
    cron: 0 15 1 * * *
  health-status:
    # in minutes, must be a number
    mail-rate: 1
    service-now-rate: 1
    smax-rate: 1

license:
  otcs-path:
    - file:./license/otcs-key.license
    - classpath:license/otcs-key.license
  otac-path:
    - file:./license/otac-key.license
    - classpath:license/otac-key.license

encryptor:
  password: s3cr3t
  # hex string
  salt: 0c6c0c6c0c6c0c6c0c6c0c6c0c6c0c6c

smax:
  # Name: Display Name
  enums:
    urgency:
      TotalLossOfService: Total Loss of Service
      SevereDisruption: Severe Disruption
      SlightDisruption: Slight Disruption
      NoDisruption: No Disruption
    impact:
      Enterprise: Enterprise
      SiteOrDepartment: Site or Department
      MultipleUsers: Multiple Users
      SingleUsers: Single Users
    completionCode:
      SuccessfulDiagnosis: Diagnosed successfully
      NoFaultFound: No fault found
      NoUserResponse: No user response
      NotReproducible: Not reproducible
      OutofScope: Out of scope
      RequestRejected: Request rejected
      Resolvedbyfix: Resolved successfully
      ResolvedWorkaround: Resolved with workaround
      UnabletoSolve: Unable to solve
      WithdrawnbyUser: Withdrawn by user

service-now:
  roles:
    - admin
    - itil_admin
    - itil

http-client:
  ssl:
    bundle: fuse
